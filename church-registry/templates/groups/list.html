{% extends "base.html" %}

{% block title %}그룹 관리{% endblock %}

{% block content %}
<div class="container">
    <!-- 페이지 헤더 -->
    <div class="page-header">
        <div>
            <h1 class="page-title">
                <i class="bi bi-diagram-3-fill"></i>
                그룹 관리
            </h1>
            <p class="page-subtitle">셀, 구역, 목장을 관리합니다</p>
        </div>
        <a href="{{ url_for('group_new') }}" class="btn-submit">
            <i class="bi bi-plus-lg"></i> 새 그룹 등록
        </a>
    </div>

    {% if groups %}
    <div class="card-grid">
        {% for group in groups %}
        <a href="{{ url_for('group_detail', group_id=group.id) }}" class="member-card">
            <div class="member-card-header">
                <div class="member-avatar" style="background:
                    {% if group.group_type == 'cell' %}linear-gradient(135deg, #667eea 0%, #764ba2 100%)
                    {% elif group.group_type == 'district' %}linear-gradient(135deg, #11998e 0%, #38ef7d 100%)
                    {% elif group.group_type == 'mokjang' %}linear-gradient(135deg, #f093fb 0%, #f5576c 100%)
                    {% else %}linear-gradient(135deg, #4facfe 0%, #00f2fe 100%){% endif %}">
                    {% if group.group_type == 'cell' %}<i class="bi bi-people"></i>
                    {% elif group.group_type == 'district' %}<i class="bi bi-building"></i>
                    {% elif group.group_type == 'mokjang' %}<i class="bi bi-house"></i>
                    {% else %}<i class="bi bi-collection"></i>{% endif %}
                </div>
                <div class="member-info">
                    <h3>{{ group.name }}</h3>
                    <p>{% if group.group_type == 'cell' %}셀
                       {% elif group.group_type == 'district' %}구역
                       {% elif group.group_type == 'mokjang' %}목장
                       {% else %}기타{% endif %}</p>
                </div>
                <span class="status-badge status-active">{{ group.members|length }}명</span>
            </div>
            <div class="member-meta">
                <span>
                    <i class="bi bi-person-badge"></i>
                    리더: {% if group.leader_id %}
                        {% set leader = group.members | selectattr('id', 'equalto', group.leader_id) | first %}
                        {{ leader.name if leader else '미지정' }}
                    {% else %}미지정{% endif %}
                </span>
            </div>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <div class="form-section">
        <div class="empty-state">
            <i class="bi bi-diagram-3"></i>
            <h3>등록된 그룹이 없습니다</h3>
            <p>첫 번째 그룹을 등록해보세요</p>
            <a href="{{ url_for('group_new') }}" class="btn-submit">
                <i class="bi bi-plus-lg"></i> 새 그룹 등록
            </a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
